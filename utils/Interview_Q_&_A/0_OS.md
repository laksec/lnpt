## 1. ðŸ’¡ Foundational OS & Security Architecture

This set covers core OS functions, security models, and data structures critical for understanding initial compromise and basic privilege escalation.

| Q# | Question | Answer (Pentesting Focus) |
| :--- | :--- | :--- |
| **1** | What is the difference between **User Mode** and **Kernel Mode**? | The **Kernel Mode** (Ring 0) is where the OS kernel executes with full privileges. Exploiting a kernel vulnerability or a driver bug allows an attacker to transition from the low-privilege **User Mode** (Ring 3) directly to the highest system privilege, bypassing standard security controls. |
| **2** | Explain **Discretionary Access Control (DAC)** vs. **Mandatory Access Control (MAC)**. | **DAC** (e.g., standard Linux permissions, Windows NTFS) allows the resource **owner** to set permissions. A pentester exploits DAC by compromising an owner account. **MAC** (e.g., SELinux, AppArmor) enforces access based on centralized, system-wide policies (security labels), making lateral movement harder even with a compromised user.  |
| **3** | How does **virtual memory** work, and why is this relevant to exploit development? | It maps physical memory to a larger virtual address space using a **Page Table**. This is crucial for **ASLR** (Address Space Layout Randomization), as the OS randomizes where these pages are mapped to make it harder for an attacker to reliably predict the address of functions/data for exploitation. |
| **4** | What is a **Process ID (PID)** and a **Parent Process ID (PPID)**? | **PID** is the unique identifier for a running process. **PPID** is the ID of the process that launched it. Pentesters use **PPID Spoofing** to hide malicious processes by having them inherit a legitimate parent (like `services.exe`) instead of an attacker's shell. |
| **5** | Define the role of the **NT File System (NTFS)** in Windows security. | **NTFS** provides file and folder-level security through **Access Control Lists (ACLs)**. Pentesters look for misconfigured ACLs (e.g., a non-admin group having **Full Control** over a sensitive executable) to escalate privileges. |
| **6** | What is a **file descriptor** in Linux? | A non-negative integer used by the kernel to identify an open file, network socket, or pipe. Attackers might exploit vulnerabilities related to file descriptor limits or manipulation to create Denial of Service (DoS) conditions. |
| **7** | How does the **Bootloader** (e.g., GRUB/UEFI) factor into OS security? | A vulnerable or unprotected bootloader can allow an attacker with local access to modify OS boot parameters, disable security features (like Secure Boot), or boot into single-user/recovery mode without a password, potentially granting root access. |
| **8** | What is a **race condition** in an OS context, and how is it exploited? | It occurs when the outcome depends on the timing of two or more threads/processes. Pentesters exploit them (e.g., on a privileged process creating a temp file) by winning the "race" and replacing a legitimate file with a malicious one between the check and the use of that file (**TOCTOU**). |
| **9** | What is the significance of the **SYSTEM** account in Windows? | It's the most powerful local account, used by the OS and services. A primary goal of a Windows pentester is to escalate privileges to the **NT AUTHORITY\SYSTEM** account, often via **Service Exploitation** or **Token Theft**. |
| **10** | Describe **SELinux** (Security-Enhanced Linux) and its three modes. | It's a security module providing **Mandatory Access Control (MAC)**. Modes are: **Enforcing** (policies active and enforced), **Permissive** (policies active but only log warnings), and **Disabled**. Pentesters check for **Permissive** mode as it signals potential misconfiguration without blocking attacks. |
| **11** | What is the purpose of the **Sudoers** file in Linux? | It defines which users can execute which commands as another user (usually **root**) without needing the root password. A misconfigured entry (e.g., allowing a low-privilege user to run a command that allows shell escapes, like `find`) is a common privilege escalation vector. |
| **12** | How is the **Windows Registry** used by an attacker for persistence? | Attackers modify keys under `HKEY_LOCAL_MACHINE` or `HKEY_CURRENT_USER` in the **Run** or **RunOnce** keys to launch malware upon system startup or user logon. **Autoruns** tool is used to identify these. |
| **13** | What does the **sticky bit** do on a Linux directory (e.g., `/tmp`)? | It restricts file deletion. Only the **owner** of a file or the **root** user can delete files in that directory, even if other users have write permissions to the directory itself. This prevents users from deleting files they don't own in shared directories. |
| **14** | Why is the **Time-of-Check to Time-of-Use (TOCTOU)** vulnerability a classic OS-level bug? | It's a specific type of race condition where the security of a file is **checked** (Time-of-Check) but an attacker quickly modifies the file before it is **used** (Time-of-Use) by the privileged process, often via symbolic or hard links. |
| **15** | Name two Linux files that store password information. | **/etc/shadow** (encrypted password hashes) and **/etc/passwd** (user account information, including a placeholder 'x' for the password, pointing to `/etc/shadow`). |
| **16** | Where are Windows local user password hashes stored, and where are they loaded? | Stored in the **SAM (Security Account Manager)** hive (a part of the Registry). They are loaded into the **LSASS** (Local Security Authority Subsystem Service) process memory when the system is running, making LSASS the primary target for credential dumping. |
| **17** | How do **Capabilities** in Linux relate to the root account? | Capabilities break the traditional root/non-root dichotomy by allowing the root user's privileges to be divided into distinct units (e.g., `CAP_NET_BIND_SERVICE`). Pentesters exploit misconfigured capabilities on binaries to gain elevated access without full root compromise. |
| **18** | Explain the concept of a **Security Identifier (SID)** in Windows. | A unique, variable-length value used to identify a security principal (a user, group, or computer account). SIDs are fundamental to Windows access control, as they are used in **ACLs** to determine permissions. |
| **19** | What are **Environment Variables** and how can they be exploited for privilege escalation? | They are dynamic named values that affect how processes behave. An attacker might exploit a misconfigured `PATH` variable to inject a malicious executable with the same name as a legitimate one, causing a privileged process to execute the malicious code. |
| **20** | What is the purpose of the **Hosts** file in both Windows and Linux? | It's a local plain-text file that maps hostnames to IP addresses. An attacker can modify it for **redirection** (e.g., redirecting a trusted update server to an attacker-controlled server) or **blocking** (e.g., blocking security tool sites). |
| **21** | What is an **Access Token** in Windows? | A data structure that describes the security context of a process or thread (including the user's **SIDs**, privileges, and integrity level). Attackers steal and impersonate tokens to elevate privileges (**Token Theft**). |
| **22** | Describe the Windows **Service Control Manager (SCM)**. | The system component that manages Windows services (starting, stopping, and running them). Attackers look for services configured with **weak file permissions** or **unquoted service paths** that allow for service binary replacement or path injection for privilege escalation. |
| **23** | What is the risk of using **SUID** on a script file in Linux? | It's usually ignored by the kernel for scripts to prevent simple privilege escalation by forcing the script interpreter to run as root. However, this rule can sometimes be bypassed or exploited in specific configurations. |
| **24** | What is **Inter-Process Communication (IPC)** and how is it used by an attacker? | Mechanisms (like pipes, sockets, shared memory) that allow processes to share data. An attacker can use IPC to inject code into other processes (Process Injection) or sniff traffic between legitimate applications. |
| **25** | What is the role of **sysctl** in Linux security hardening? | It's used to modify kernel parameters at runtime (e.g., disabling ICMP redirects, enabling TCP SYN cookie protection, or hardening shared memory access). Pentesters look for weak settings that might aid in network attacks. |
| **26** | Explain the concept of **Inherited Privileges** in Windows NTFS. | Permissions set on a parent folder are automatically passed down to child files and subfolders. A pentester exploits this by modifying permissions on a low-level object if the inheritance chain is misconfigured. |
| **27** | What is a **Linux socket**? | An endpoint for communication flow between two programs, either on the same machine (Unix Domain Socket) or over a network (TCP/UDP socket). Attackers scan for open sockets and attempt to exploit network service vulnerabilities. |
| **28** | Define **Code Signing** and its relevance to OS security. | A cryptographic signature on an executable file to verify its author and ensure it hasn't been tampered with. Attackers often target processes that ignore or misuse code signing checks. |
| **29** | What is the purpose of the **systemd** init system in Linux? | It's the standard **service and system manager** that controls how processes start, stop, and manage dependencies. Attackers can exploit custom or misconfigured systemd units for persistence or privilege escalation. |
| **30** | How does the **Windows firewall** classify networks, and why is this important for a pentester? | It classifies them as **Domain**, **Public**, or **Private**. Firewall rules are often much less restrictive on the **Domain** or **Private** profile, which an attacker can leverage if they can force a victim machine to switch its network profile. |
| **31** | Where are **user startup files** typically located in Linux, and how can they be used for persistence? | Files like `~/.bashrc`, `~/.profile`, or `~/.bash_logout` are executed at shell startup/exit. An attacker can append commands (like a reverse shell) to these files to regain access whenever the user logs in. |
| **32** | What is the concept of a **Non-Paged Pool** in Windows? | A section of kernel memory that **cannot** be swapped out to disk. Kernel exploits targeting this area must be precise, but they offer high reliability once achieved. |
| **33** | How does an attacker leverage **Weak File Permissions** on a Windows service executable? | If a low-privilege user has **Write** access to the service binary, they can replace the legitimate executable with a malicious one (e.g., a reverse shell) that will then execute with the service's privileges (often **SYSTEM** or **LocalService**). |
| **34** | What is a **symbolic link (symlink)**, and how is it used in privilege escalation? | A file that points to another file or directory. Attackers use symlinks in **TOCTOU** attacks to redirect a privileged process's file operation (like writing logs) to a sensitive system file (like `/etc/shadow`). |
| **35** | Describe the function of the **Windows Event Log** system. | It records system, security, and application events. Pentesters must examine the **Security Log** for failed logon attempts, privilege changes, and the execution of specific processes. Attackers focus on clearing logs (`Event ID 1102` is the log clear event). |
| **36** | What are **Linux Control Groups (cgroups)**? | A Linux kernel feature that limits, accounts for, and isolates the usage of system resources (CPU, memory, disk I/O, network) for groups of processes. They are fundamental to **Container Isolation**. |
| **37** | Define the security risk of an **Unquoted Service Path** in Windows. | If a service executable path is not enclosed in quotes and contains spaces (e.g., `C:\Program Files\My App\service.exe`), Windows will search for executables in each directory segment (`C:\Program.exe`, then `C:\Program Files\My.exe`, etc.). An attacker can place a malicious executable early in the path for execution. |
| **38** | Why is the **PATH environment variable** dangerous if misconfigured in Linux? | If the root user's `PATH` includes the current directory (`.`), an attacker can create a malicious script with the same name as a common command (`ls`, `find`, etc.). If root executes the command from that directory without specifying the full path, the attacker's script runs with root privileges. |
| **39** | Explain **SACLs (System Access Control Lists)** in Windows. | The part of a **Security Descriptor** that defines which access attempts (success or failure) are logged to the Windows Security Event Log. Pentesters look for missing SACLs that would allow stealthy activity. |
| **40** | How do attackers find **installed software versions** on Windows? | By querying the registry keys under `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall` or using the **Windows Management Instrumentation (WMI)** via tools like **PowerShell**. |
| **41** | What is a **chroot jail**, and what is the primary method to escape it? | A change to the apparent root directory for a process, isolating it. The primary escape method is exploiting the ability to access relative paths outside the jailed environment or exploiting a kernel vulnerability if the jail is not properly configured (e.g., lacking device nodes). |
| **42** | What is the primary purpose of the **GUID Partition Table (GPT)**? | It's a standard for the layout of partition tables on a physical hard disk. Its security relevance is that it often includes redundancy and checks that modern OSes rely on for boot integrity (like **UEFI Secure Boot**). |
| **43** | How are **Linux Log Files** used in post-exploitation reconnaissance? | Files in `/var/log/` (e.g., `auth.log`, `dmesg`, `apache/nginx logs`) contain records of user logins, failed attempts, service activity, and system changes, which help pentesters understand the environment and identify sensitive data. |
| **44** | What is the Windows **AppLocker** feature? | A Microsoft technology that allows administrators to control which programs users can run based on file attributes (like name, publisher, version) or file path. Attackers attempt to bypass it by using whitelisted **LOTL (Living Off The Land)** binaries like PowerShell or MSBuild. |
| **45** | Define a **Daemon** (Linux) or a **Service** (Windows). | A background program that runs without direct user interaction, providing system or application functions (e.g., web server, SSH, logging). They are high-value targets as they often run with elevated privileges (**root** or **SYSTEM**). |
| **46** | Why is the **Windows Installer (MSI) database** a target for a pentester? | The MSI database contains configuration details for installed software, including repair commands. If the repair command points to a writable location, an attacker can use it for persistence or privilege escalation during a system repair operation. |
| **47** | What is **Linux Auditing (auditd)**, and how does it affect a pentest? | A system that provides detailed logging of security-relevant events (e.g., system calls, file access). Its presence means a pentester's every action (e.g., reading `/etc/shadow`, modifying a file) is potentially logged, necessitating stealthier tactics. |
| **48** | Explain the significance of the **`/etc/securetty`** file in older Linux systems. | It restricts root logins only to specified TTY devices (consoles). If it's missing or misconfigured, an attacker could potentially log in as root from any terminal or SSH session. |
| **49** | How is a **weak `ACL` or `DACL` on a user's profile directory** (Windows) exploited? | If a low-privilege user has write access to the profile directory of another user (especially an administrator), they can inject malicious scripts or configuration files that execute the next time the target user logs on. |
| **50** | What are **Unix/Linux Groups**, and why are they critical for escalation? | A mechanism to manage shared permissions. If an attacker compromises a user who belongs to a powerful group (e.g., **`docker`**, **`disk`**, **`adm`**, or **`wheel`**), the attacker gains the combined privileges of that group, which often leads to root access. |
| **51** | Define **Data Execution Prevention (DEP)** and a common bypass. | **DEP** marks specific memory areas (like the stack and heap) as non-executable, preventing code from running from data segments (blocking classic stack overflows). Attackers bypass it using **Return-Oriented Programming (ROP)**, chaining together legitimate code snippets ("gadgets") already in executable memory. |
| **52** | What is **Address Space Layout Randomization (ASLR)** and how is it defeated? | **ASLR** randomly arranges the memory addresses of key program areas (stack, heap, libraries) upon launch. Defeating it relies on an **information leak** (e.g., a vulnerable function that prints a memory address) to calculate the random offset, effectively de-randomizing the addresses.  |
| **53** | Explain the role of **Stack Canaries** (or Stack Cookies). | A small, secret value placed on the stack before the function's local variables. If a buffer overflow attempts to overwrite the return address, it must overwrite the Canary first. The function checks the Canary's integrity before returning; if it's corrupted, the program aborts, preventing the exploit. |
| **54** | What is **Control-Flow Integrity (CFI)**? | A modern mitigation that restricts where a program's execution can jump (e.g., preventing ROP). It checks that indirect jumps/calls and function returns lead to valid, pre-determined locations, significantly limiting ROP chain effectiveness. |
| **55** | Define a **Use-After-Free (UAF)** vulnerability. | A bug where a program continues to use a pointer to memory that has already been **freed** (deallocated). An attacker manipulates the heap to allocate their own data (payload) in that newly freed space, causing the program to execute their payload when the old pointer is dereferenced. |
| **56** | What is the purpose of the **No Execute (NX) bit**? | It is the hardware implementation of **DEP**. It's a bit in the page table entry that tells the CPU not to execute instructions from that memory page, enforcing the separation of code and data. |
| **57** | Describe the vulnerability of **NetBIOS** or **SMB/Samba** on a network. | **SMB (Server Message Block)** (ports 139, 445) is often exposed when it shouldn't be. Vulnerabilities include remote code execution (e.g., **EternalBlue**), weak NTLM authentication, and allowing **null sessions** for anonymous enumeration. |
| **58** | What is the security implication of an **open FTP** service (ports 20, 21)? | If configured with anonymous access or weak credentials, it allows unauthorized file uploads/downloads. A pentester can use it to upload a **web shell** or exploit features like `SITE EXEC` for remote command execution. |
| **59** | How does an attacker exploit an insecure **DNS Zone Transfer**? | DNS Zone Transfer allows replicating the entire DNS database (all records) from the primary to secondary servers. If not restricted to authorized IPs, an attacker can obtain a complete map of internal hostnames and IP addresses for reconnaissance. |
| **60** | Explain how **ARP Spoofing** is performed. | The attacker sends forged **ARP (Address Resolution Protocol)** replies to a target (often the switch or router), associating the attacker's MAC address with the IP address of another device on the local network. This enables sniffing traffic between the two targets. |
| **61** | What is the risk of an **open Telnet** service (port 23)? | Telnet transmits all data, including login credentials, **in plaintext**. A pentester will sniff traffic to capture credentials, unlike modern alternatives like SSH which encrypt all communication. |
| **62** | How do you identify a **weak SSH configuration** on a Linux server? | Look for: **weak cipher suites** (e.g., CBC modes), use of **SSH Protocol 1**, enabling **root login**, or allowing **password authentication** when key-based authentication is mandatory. |
| **63** | Describe the common vulnerability of a **misconfigured NFS (Network File System) share**. | If the NFS share is exported with the **`no_root_squash`** option, a user who mounts the share and gains root on their client machine is treated as root on the NFS server, allowing full system access. |
| **64** | What is a **Null Session** in Windows, and why is it a security risk? | An unauthenticated connection to a Windows host's IPC$ administrative share. It historically allowed attackers to enumerate user lists, share names, and even registry keys, aiding in early reconnaissance. |
| **65** | What is the significance of the **RDP (3389)** service in a Windows internal pentest? | It's the primary way administrators manage systems. Once credentials are stolen (via PtH/Kerberoasting), RDP is used for easy, interactive **lateral movement** to high-value servers. |
| **66** | Explain the difference between **TCP** and **UDP** and how this affects service exploitation. | **TCP** is connection-oriented and reliable (used by HTTP, SSH). **UDP** is connectionless and faster (used by DNS, SNMP). UDP services are prone to **DoS (Denial of Service)** attacks (e.g., DNS amplification) because they don't require session establishment. |
| **67** | How can a pentester use a **firewall misconfiguration** involving outbound traffic? | If a stateful firewall is configured too loosely, it might allow *any* established *outbound* connection. This allows an attacker to establish a **reverse shell** connection from the victim back to the C2 server, bypassing inbound filtering. |
| **68** | What is **SNMP (Simple Network Management Protocol)** and its security weakness? | Used to manage network devices. Versions 1 and 2 often use **community strings** (passwords) sent **in plaintext** over the network (e.g., `public`, `private`). Compromise allows full device enumeration and sometimes configuration changes. |
| **69** | Define **Cross-Origin Resource Sharing (CORS)** and how a misconfiguration can expose OS resources. | **CORS** is a mechanism allowing resources (like web services) on a web server's OS to be accessed by a webpage from another domain. A weak CORS policy (e.g., allowing `Access-Control-Allow-Origin: *`) can allow an attacker's website to retrieve data from internal web services. |
| **70** | Why is the **WINS (Windows Internet Name Service)** service relevant to older Windows pentests? | **WINS** resolves NetBIOS names to IP addresses. It often leaks information about the network structure and can be vulnerable to spoofing, especially in older, unsegmented internal environments. |
| **71** | How is **Heap Exploitation** different from Stack Exploitation? | **Stack Exploitation** involves overwriting the function return address to hijack control flow. **Heap Exploitation** involves manipulating the memory management structures (like the free list) to corrupt pointers and redirect program execution or write arbitrary data to memory locations. |
| **72** | What are **AS-IS and TO-BE checks** (or **Safe Unlinking**) in heap security? | These are security checks implemented in the OS's memory allocator (like glibc) to prevent heap exploitation. They verify that the memory structure (e.g., the forward and backward pointers in a chunk) is consistent before linking or unlinking memory, blocking common heap overflow techniques. |
| **73** | Define **Integer Overflow** and how it leads to memory exploitation. | A bug where an arithmetic operation attempts to create a numeric value that is outside the range that can be represented by the available storage space (e.g., a 16-bit integer). This can lead to security issues by causing an attacker-supplied value to be interpreted as a small number, often leading to a small, exploitable buffer allocation size. |
| **74** | What is **Sandbox Escape**? | An attack where a compromised application or process running in a restricted execution environment (a "sandbox," often implemented using OS features like **namespaces** or **seccomp**) manages to break out of the sandbox and interact with the host operating system. |
| **75** | How do modern operating systems defend against **Unsafe DLL Loading** (DLL Hijacking)? | Windows uses features like **Known DLLs** (system DLLs loaded from a trusted path) and **SafeDllSearchMode** (restricting search paths) to prevent an attacker from placing a malicious DLL in a directory that a legitimate, privileged process will load. |
| **76** | What is the purpose of **seccomp (Secure Computing Mode)** in Linux? | It's a kernel feature that restricts the **system calls** a process is allowed to make. It's heavily used in containers to reduce the kernel attack surface, allowing only necessary system calls, thus improving isolation. |
| **77** | How can **Misconfigured IIS/Apache Web Server** logs be exploited? | If the logs are writable by the web service account, an attacker can inject malicious code or commands into the log file (e.g., via a crafted HTTP request). If the log file is then processed by a tool that executes the content, it leads to code execution. |
| **78** | What is a **SYN Flood** attack? | A Denial of Service (DoS) attack that exploits the three-way handshake of the **TCP** protocol. The attacker sends many **SYN** requests but never responds to the server's **SYN-ACK**, causing the server to exhaust its resources waiting for the final **ACK**. |
| **79** | How is **ICMP (Internet Control Message Protocol)** used maliciously (outside of simple ping)? | It can be used for **covert communication (ICMP tunneling)**, where C2 traffic is encapsulated in ICMP echo/reply packets to bypass firewalls that often allow all ICMP traffic. It's also used in **Smurf** DoS attacks. |
| **80** | Explain **Time-based Blind SQL Injection** and how it exploits the OS/Database interaction. | The attacker uses **time delay functions** (e.g., `SLEEP(5)`) in SQL queries. If the application takes 5 seconds longer to respond, the attacker confirms their query was executed by the underlying database/OS, allowing data extraction without seeing output. |
| **81** | What is the purpose of the **system call interface** in the OS? | It's the layer that allows User Mode applications to request services from the Kernel (e.g., file I/O, process creation, network operations). Exploits often target this interface (or the parameters passed to it) to gain control of the kernel. |
| **82** | How can a **Jailbreak** in an embedded OS be achieved? | By exploiting a vulnerability in a restricted environment (like iOS, game consoles, or routers) to gain root access. This often involves memory corruption in system services or exploiting configuration flaws in the kernel. |
| **83** | What is the role of **Virtual Address Descriptors (VADs)** in Windows security? | VADs are internal kernel structures that describe the memory regions used by each process. Tools can analyze VADs to detect hidden or injected memory regions characteristic of process hollowing or rootkits. |
| **84** | How does an attacker use a **Misconfigured NTP (Network Time Protocol) server**? | NTP (port 123) is used for time synchronization. Vulnerable or misconfigured servers can be used in **amplification attacks** (DoS) or exploited to cause time synchronization failures, which can interfere with Kerberos authentication. |
| **85** | What is **Rowhammer** in the context of OS exploitation? | A hardware vulnerability where repeatedly accessing a row of memory can cause electrical interference in adjacent rows, potentially flipping a bit. This can be exploited to bypass OS memory security (like DEP/ASLR) and gain kernel access. |
| **86** | Explain the concept of **Side-Channel Attacks** on an OS level. | Attacks that exploit information leaked from the physical execution of a system (e.g., timing information, power consumption, electromagnetic radiation) rather than the logical function. **Spectre** and **Meltdown** are examples exploiting CPU features. |
| **87** | How is **IP Spoofing** used maliciously? | Changing the source IP address in a packet to hide the attacker's identity or to impersonate another legitimate host. It's often used in **DoS attacks** to hide the source or in conjunction with firewall misconfigurations. |
| **88** | What is the vulnerability associated with a **misconfigured TFTP (Trivial FTP)** server (port 69)? | TFTP is a simple file transfer protocol that often lacks authentication. If misconfigured, it can allow an attacker to download sensitive configuration files (like router configs or boot files) or upload malicious files to the server. |
| **89** | Define **TOCTOU (Time-of-Check to Time-of-Use)** again, specifically for a privileged file access. | The exploit targets the brief window between when a privileged process checks the security of a file (e.g., checking it's a regular file) and when it actually uses it (e.g., writing to it), allowing the attacker to substitute a symlink to a sensitive file. |
| **90** | What is the risk of a **World-Writable** directory on a Linux server? | Any local user can create, modify, or delete files in that directory. If a privileged service reads or executes files from this directory, an attacker can substitute a malicious file for exploitation. |
| **91** | How is **ICMP Redirect** used in a Man-in-the-Middle (MITM) attack? | An attacker sends an ICMP Redirect message to a host, telling the host that a better path to a specific destination IP exists through the attacker's machine. This redirects traffic through the attacker without ARP Spoofing. |
| **92** | What are **Socket File Permissions** in Linux, and why are they important? | Unix Domain Sockets are used for local IPC and rely on standard filesystem permissions. If a sensitive socket file (e.g., the Docker socket) has permissive permissions, a low-privilege user can interact with the service it controls. |
| **93** | How can **Port Knocking** be defeated by an attacker? | Port knocking hides services by requiring a sequence of connections (knocks) to closed ports to open the actual service port. It can be defeated by **sniffing** the network for the correct sequence or by **brute-forcing** the sequence. |
| **94** | What is the security function of a **DMZ (Demilitarized Zone)**? | A segment of the network that sits between the internal network and the internet, containing public-facing services (e.g., web servers). The goal is to isolate public services so that if they are compromised, the attacker cannot easily pivot to the internal network. |
| **95** | Explain **VLAN Hopping** and its OS-level reconnaissance implications. | An attack that allows a host on one VLAN to gain access to traffic or resources on a different VLAN. This allows a pentester to expand their network view far beyond their initial compromised segment. |
| **96** | How is a **weak `CURL` or `WGET` command** exploited for initial access? | If a system uses `curl` or `wget` without proper certificate verification (`-k` or `--no-check-certificate`), an attacker can perform a **MITM** attack to serve a malicious payload instead of the intended file. |
| **97** | What is a **Buffer Underflow**? | A security flaw where data is written to a buffer before its starting address, typically corrupting adjacent data in memory. While less common than overflow, it can be equally devastating, potentially leading to arbitrary code execution. |
| **98** | Define **Code Reuse Attacks** (general term for ROP, etc.). | A class of attacks where the attacker doesn't inject new code but instead forces the program to execute small sequences of existing, legitimate code (gadgets) already present in the executable memory space to achieve malicious functionality. |
| **99** | What is the function of the **`boot-init`** process in Linux bootup? | It's the very first process executed by the kernel (PID 1). It's responsible for starting the rest of the system, including loading modules, mounting filesystems, and launching services. Compromising this process is a route to full system control. |
| **100** | How are **Firewall Evasion** techniques used against OS-level firewalls (e.g., IPTables/Windows Firewall)? | Techniques include **Packet Fragmentation** (splitting the TCP/UDP packet to bypass simple rule sets), **Protocol Tunneling** (DNS or ICMP tunneling), and **Source Port Spoofing** (using ports typically trusted by firewalls, like 53 or 80). 

| **101** | Describe the **Pass-the-Hash (PtH)** attack. | An attacker steals an **NTLM hash** (not the plaintext password) from a compromised machine's memory (**LSASS**) and uses it to authenticate to other services (like SMB/RDP) on the network. It works because Windows uses the hash for challenge/response authentication, never needing the plaintext password. |
| **102** | What is **Kerberoasting**? | An attack where a pentester, as any authenticated domain user, requests a Kerberos Ticket-Granting Service (TGS) ticket for a **Service Account** (identified by its **SPN**). The ticket is encrypted with the service account's password hash, which can then be cracked **offline** to retrieve the password. |
| **103** | How is **PowerShell** leveraged for defense evasion and post-exploitation? | PowerShell is a **Living Off The Land (LOTL)** binary. Attackers use it for *fileless* attacks (running code directly in memory), *reflective DLL injection*, and system management tasks (like checking firewall rules, WMI calls, or credential harvesting) without dropping detectable payloads to disk. |
| **104** | What is **LSASS** (Local Security Authority Subsystem Service), and why is it a primary target? | It's a critical Windows process that enforces security policy and stores credential information, including **plaintext passwords** (if configured) and **NTLM/Kerberos hashes/tickets** for currently logged-on users. Tools like **Mimikatz** target LSASS for credential dumping. |
| **105** | Explain **WMI (Windows Management Instrumentation)** and its use in lateral movement. | **WMI** is an OS feature for managing local and remote computers. Attackers use WMI to execute commands remotely on other systems without dropping an executable file (a **fileless** technique), often via the `Win32_Process` class's `Create` method. |
| **106** | What is a **Golden Ticket** attack? | Forging a Kerberos **Ticket Granting Ticket (TGT)** for any user (usually a Domain Admin) using the hash of the **KRBTGT** account (the Kerberos service account). This grants unlimited, long-term access to any resource in the domain, effectively achieving domain dominance. |
| **107** | How can **Group Policy Objects (GPOs)** be used for persistence or lateral movement? | An attacker with GPO edit privileges can push malicious startup scripts, scheduled tasks, or software installations to all machines in a targeted Organizational Unit (OU), achieving widespread persistence or payload execution. |
| **108** | What is **UAC (User Account Control)**, and what is a common bypass technique? | **UAC** is a security boundary that separates standard user privileges from administrator privileges. Bypasses often involve exploiting trusted, Microsoft-signed executables (e.g., `fodhelper.exe`) that are configured to **auto-elevate** without prompting the user. |
| **109** | How is **Sysmon** used for detection, and how might an attacker attempt to evade it? | **Sysmon** logs highly detailed process activity, network connections, and file modifications. Attackers try to evade it by **Process Hollowing/Injection** (running malicious code inside a whitelisted process) or by cleaning specific **Windows Event Log** IDs (**log clearing**). |
| **110** | What is a **Service Principal Name (SPN)**? | A unique identifier for a service instance (e.g., `MSSQLSvc/host.domain:1433`). It's used by Kerberos to map a service to its service account, making it the key identifier for **Kerberoasting** attacks. |
| **111** | Describe the **DLL Sideloading** technique. | An attacker places a malicious DLL in a directory that a legitimate application (often one with poor security) searches for an expected system DLL. The legitimate application is tricked into loading the malicious DLL, executing the attacker's code with the application's privileges. |
| **112** | How can **Scheduled Tasks** be used for persistence? | Attackers use the `schtasks.exe` command to create a new task that executes a payload at a specific time or event (e.g., every user logon), ensuring the payload runs repeatedly with the task's defined permissions. |
| **113** | What is the **DC Sync** attack, and what credential is required? | An attack where a compromised account is granted the necessary Active Directory permissions to request replication data from a Domain Controller (DC). This allows the attacker to retrieve the full set of NTLM hashes for all users, including the **KRBTGT** hash. It requires the **"Replicating Directory Changes All"** privilege. |
| **114** | Define **Pass-the-Ticket (PtT)**. | An attacker steals a user's Kerberos **Ticket Granting Ticket (TGT)** from memory and uses it to authenticate to other services. Unlike PtH (which uses the hash), PtT uses the actual ticket, which is common in environments that heavily rely on Kerberos. |
| **115** | How is **Netcat** used on a Windows host for initial access or pivoting? | While not native, a dropped Netcat executable is often used to establish a **reverse shell** (connecting back to the attacker) or a **bind shell** (listening for the attacker) for basic command and control (C2) after initial exploitation. |
| **116** | What is the risk of a **weak local administrator account password**? | It enables **Lateral Movement** via **Pass-the-Hash (PtH)** if that local admin password is the same (or the hash is the same) across multiple machinesâ€”a vulnerability known as **Local Administrator Password Solution (LAPS)** bypass. |
| **117** | How can a pentester use the **`net` commands** for reconnaissance? | Commands like `net user`, `net group`, `net view`, and `net share` are used to enumerate local users, groups, shared drives, and visible computers on the network without using specialized tools. |
| **118** | What is **Process Injection**, and how is it a form of defense evasion? | Injecting a malicious payload into the memory space of a legitimate, running process (e.g., `explorer.exe`). It evades signature-based detection because the malicious code is never written to disk and runs under the identity of a trusted process. |
| **119** | How do you check a Windows system for **writable services**? | Use tools like **`accesschk.exe`** or PowerShell scripts to examine the **Security Descriptor** on service objects in the **Service Control Manager (SCM)** to find if a low-privilege user can modify the service's configuration or binary path. |
| **120** | Explain the concept of **Token Impersonation** (or Theft). | An attack where an attacker steals an **access token** from a highly privileged process (like the OS or a running service) and uses it to impersonate that user, gaining the associated privileges (often **SYSTEM** or a Domain Admin's privileges). |
| **121** | What are **Startup Folders** in Windows, and how are they used for persistence? | The `Startup` folders (under the user's profile or `All Users`) contain shortcuts or executables that run automatically when the user logs in. Placing a link to a payload here ensures persistence upon logon. |
| **122** | How can an attacker use **Windows Defender exclusions** for evasion? | If a process, file path, or file type has been added to the Windows Defender exclusion list, the attacker can drop their payload in that location or use that process to run their code, bypassing signature and behavioral analysis. |
| **123** | Define **Trusts** in Active Directory and how they are exploited. | Trusts allow users in one domain to access resources in another. They are exploited in **Trust Key** attacks, where an attacker compromises a domain and then uses the trust relationship (and the trust password/key) to pivot to the other trusting domain. |
| **124** | What is **Local Security Authority (LSA) Protection**? | A mitigation feature that protects the **LSASS** process from memory injection or reading by unauthorized processes, making credential dumping with tools like Mimikatz much harder unless the protection is disabled or bypassed via kernel-level techniques. |
| **125** | How can **Windows Firewall rules** be manipulated for C2 communication? | An attacker can use `netsh advfirewall` commands to create a new **outbound** rule that allows their C2 traffic (e.g., communication to a specific IP on a non-standard port) to pass the firewall unnoticed. |
| **126** | What is the role of the **`RunAs`** command in privilege escalation? | The **`RunAs`** command allows a user to run a specific program as a different user. If an attacker knows the credentials for a high-privilege account, they can use `RunAs` to elevate the privileges of their shell or payload execution. |
| **127** | How can you search for sensitive files on a Windows machine using the command line? | Use the **`dir /s`** command with specific search terms, or more effectively, use **PowerShell** with `Get-ChildItem -Recurse -Filter "*.config"` or similar filters to search for credentials in configuration files. |
| **128** | What is **Unattended Installation** (Unattend.xml) and the security risk? | An XML file used by Windows Setup to automate installation. It can sometimes contain **plaintext passwords** for local or domain administrator accounts, making it a high-value target for reconnaissance. |
| **129** | Describe a basic **NetBIOS Enumeration** technique. | Using tools like **`nbtstat`** or specialized scripts to query a target's NetBIOS name table, revealing registered names, machine roles, and logged-on users, which aids in targeting specific user accounts. |
| **130** | What is the significance of the **RDP (3389) port** in lateral movement? | Remote Desktop Protocol (RDP) is a primary pathway for attackers to move laterally. Once credentials are stolen (via PtH or Kerberoasting), RDP is used to log directly into high-value servers or user workstations for interactive control. |
| **131** | What is a **Web Shell** and how is it used for OS access? | A malicious script (e.g., ASPX, PHP) uploaded to a web server that allows an attacker to execute arbitrary **OS commands** via a web browser interface. It grants shell access with the privileges of the web service account (e.g., `IIS APPPOOL`). |
| **132** | How do attackers use the **`Bypass` execution policy** in PowerShell? | The **Execution Policy** restricts what PowerShell scripts can run. Attackers bypass this restriction using the flag `Bypass` to ensure their downloaded or injected scripts execute without user confirmation or security checks. |
| **133** | What is **System Center Configuration Manager (SCCM)** and its role in AD exploitation? | SCCM is a centralized tool for managing endpoints. If compromised, an attacker can use it to push their own software or configuration updates to thousands of machines, achieving silent and widespread compromise and persistence. |
| **134** | Explain the risk of an **NTLMv1 or NTLMv2 session security downgrade**. | Older NTLM versions (v1) and weak configurations are vulnerable to relay attacks and easy cracking. Attackers can sometimes force a server to downgrade to a weaker version during the challenge/response handshake to capture and crack the hash more quickly. |
| **135** | How do you manually dump the contents of the **SAM** hive? | The SAM hive is locked while Windows is running. Pentesters typically use utilities like **VSSAdmin** to create a **volume shadow copy**, then copy the SAM and SYSTEM hives from the snapshot for offline credential extraction. |
| **136** | What is a **Windows Service Path Hijack**? | Exploiting an **Unquoted Service Path** vulnerability by placing a malicious executable in a directory earlier in the path search order, causing the Service Control Manager to execute the malicious binary instead of the legitimate one when the service starts. |
| **137** | How does an attacker use **`psexec`** for remote execution? | `psexec` (part of Sysinternals) is a legitimate tool used to execute processes on remote Windows systems. Pentesters use it with stolen credentials to establish remote shells or execute payloads, often relying on the **Admin$** share. |
| **138** | What is a **Shadow Credentials** attack? | A modern Kerberos attack where an attacker abuses **certificate templates** to add a malicious certificate to a target user account, enabling them to forge tickets (like a Golden Ticket) for that user, achieving privilege escalation. |
| **139** | Where are **RDP credentials** sometimes cached in the Windows OS? | Credentials for RDP connections can be found in the **Windows Vault** (Credential Manager) or in the memory of the **`mstsc.exe`** process, making them a target for credential dumping tools. |
| **140** | How is **Fileless Malware** primarily deployed on Windows? | It's typically deployed via memory injection techniques using PowerShell or VBScript, where the payload never touches the disk and executes directly from the memory of a legitimate process (e.g., using **reflective DLL loading**). |
| **141** | What is the purpose of the **`whoami /priv`** command in reconnaissance? | It lists the user's current security privileges and corresponding SIDs. A pentester looks for powerful privileges like **`SeDebugPrivilege`** (needed for LSASS access) or **`SeImpersonatePrivilege`** (needed for token theft) as potential escalation vectors. |
| **142** | Describe the vulnerability of **IIS Anonymous Authentication** being configured to use a high-privilege account. | If the anonymous IUSR account is configured to run as a high-privilege account (like Administrator or Domain User), any file upload or web shell executed will run with that elevated privilege, leading to immediate system compromise. |
| **143** | How does an attacker leverage a **weakly configured shared folder** (**SMB share**)? | If a share is accessible with read/write permissions by a compromised low-privilege user, the attacker can drop payloads, configuration files, or steal sensitive data like configuration backups and developer keys. |
| **144** | What is the significance of the **`SYSTEM` hive** in offline credential extraction? | The `SYSTEM` hive of the Registry contains the **SYSKEY** (or its modern equivalent) used to encrypt the local password hashes stored in the **SAM** hive. The SYSTEM hive is required to decrypt the SAM hashes offline. |
| **145** | How is the **Windows Firewall** sometimes bypassed using conflicting rules? | By creating rules that are too broad or conflicting (e.g., an implicit allow that overrides a specific deny rule). Attackers look for these conflicting rules, often related to services like **RDP** or **SMB**, to maintain access. |
| **146** | What is **Process Monitoring** in the context of Windows security? | The active logging and analysis of all new process creation and execution events. Attackers try to evade it by running code in memory or by using trusted **LOTL** executables whose activity is often suppressed by baseline monitoring. |
| **147** | Explain the attack vector of **Misconfigured Kerberos Delegation**. | If a service is configured for **unconstrained delegation**, the service account can impersonate **any** user that authenticates to it. If the service account is compromised, the attacker can trick a high-privilege user into authenticating, then impersonate them across the domain. |
| **148** | What are **Windows Shadow Copies** and how are they used in post-exploitation? | The Volume Shadow Copy Service creates snapshots of files and volumes. Attackers use tools like **VSSAdmin** to access these snapshots to retrieve older versions of sensitive files (like database backups or configuration files) that may have since been deleted. |
| **149** | How can **Windows Management (MSI)** be abused for persistence? | An attacker with write access to the MSI database or related files can use the **`CustomAction`** functionality to embed malicious code that executes with elevated privileges during the software installation or repair process. |
| **150** | What is the security implication of an **internal DNS server** being writable by domain users? | It allows for **DNS Poisoning**. An attacker can add malicious DNS records (e.g., pointing `login.domain.local` to their phishing server) to redirect internal traffic and harvest credentials from other users. |

